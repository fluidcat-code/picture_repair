<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>图片编辑打印</title>
    </head>
    <body>
        <div class="container">
            <!-- <h1>图片编辑打印</h1> -->

            <div id="editPreview" class="main-content page active">
                <div class="left-panel">
                    <div class="controls">
                        <div class="control-group">
                            <h3>通用设置</h3>
                            <div class="button-group">
                                <label for="fileInput" class="file-label">选择图片</label>
                                <input type="file" id="fileInput" accept="image/*">
                                <button id="downloadBtn" class="download-btn" disabled hover="">下载所有图片</button>
                            </div>
                            <div class="button-group">
                                <button id="undoBtn" disabled>撤销</button>
                                <button id="redoBtn" disabled>重做</button>
                            </div>
                        </div>

                        <div class="control-group">
                            <h3>旋转</h3>
                            <div class="rotate-controls">
                                <span>角度:</span>
                                <input type="range" id="rotateSlider" class="rotate-slider"
                                    min="-180" max="180" value="0" step="1">
                                <div class="rotate-input-container">
                                    <input type="number" id="rotateInput" class="rotate-value"
                                        min="-180" max="180" value="0" step="1">
                                    <span>°</span>
                                </div>
                            </div>
                            <div class="button-group">
                                <button id="rotateLeftBtn">左转90°</button>
                                <button id="rotateRightBtn">右转90°</button>
                                <button id="resetRotateBtn">重置旋转</button>
                            </div>
                        </div>

                        <div class="control-group">
                            <h3>裁剪</h3>

                            <div class="button-group">
                                <button id="cropSwitchBtn">点击开始裁剪</button>
                                <button id="cropBtn" disabled>裁剪</button>
                                <button id="cleanPointsBtn" disabled>清除选择区域</button>
                            </div>
                        </div>

                        <div class="control-group">
                            <h3>切割</h3>
                            <div class="button-group">
                                <button id="splitSwitchBtn">点击开始切割</button>
                                <button id="splitImageBtn" disabled>切割</button>
                                <button id="clearSplitBtn" disabled>清除切线</button>
                                <div class="split-input-container">
                                    <span class="split-input-label">横向:</span>
                                    <input type="number" id="horizontalLines" class="split-input" min="0" max="4" value="0">
                                    <button id="decreaseH" disabled>-</button>
                                    <button id="increaseH" disabled>+</button>
                                </div>
                                <div class="split-input-container">
                                    <span class="split-input-label">纵向:</span>
                                    <input type="number" id="verticalLines" class="split-input" min="0" max="4" value="0">
                                    <button id="decreaseV" disabled>-</button>
                                    <button id="increaseV" disabled>+</button>
                                </div>
                            </div>
                        </div>

                        <div class="control-group">
                            <h3>滤镜调整</h3>
                            <div class="image-selector">
                                <select id="filterImageSelector">
                                    <option value="main_canvas">编辑主图</option>
                                </select>
                            </div>
                            <div class="filter-controls-compact">
                                <div class="filter-row">
                                    <div class="filter-item">
                                        <span class="filter-label">亮度</span>
                                        <input type="range" id="brightness" class="filter-slider" min="0" max="200" value="100">
                                        <span class="filter-value" id="brightness-value">100%</span>
                                    </div>
                                    <div class="filter-item">
                                        <span class="filter-label">对比度</span>
                                        <input type="range" id="contrast" class="filter-slider" min="0" max="200" value="100">
                                        <span class="filter-value" id="contrast-value">100%</span>
                                    </div>
                                </div>
                                <div class="filter-row">
                                    <div class="filter-item">
                                        <span class="filter-label">饱和度</span>
                                        <input type="range" id="saturate" class="filter-slider" min="0" max="200" value="100">
                                        <span class="filter-value" id="saturate-value">100%</span>
                                    </div>
                                    <div class="filter-item">
                                        <span class="filter-label">灰度</span>
                                        <input type="range" id="grayscale" class="filter-slider" min="0" max="100" value="0">
                                        <span class="filter-value" id="grayscale-value">0%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="button-group">
                                <button id="applyToAllBtn">应用到所有图片</button>
                                <button id="resetFiltersBtn">重置滤镜</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="right-panel">
                    <div class="canvas-container">
                        <canvas id="main_canvas"></canvas>
                    </div>
                </div>
            </div>
            <!-- 打印预览容器 - 与主编辑页同级 -->
            <div id="printPreview" class="print-preview page" style="display: none;">
                <div class="print-content">
                    <div class="left-panel">
                        <div class="controls">
                            <div class="control-group">
                                <h3>选择图片</h3>
                                <div class="compact-section-header">
                                    <div class="selection-options">
                                        <label class="selection-item">
                                            <input type="checkbox" id="printEdited" >
                                            <span>编辑后的图片</span>
                                        </label>
                                        <label class="selection-item">
                                            <input type="checkbox" id="printSplit" checked>
                                            <span>切割后的图片</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="control-group">
                                <h3>纸张预览</h3>
                                <div class="paper-buttons">
                                    <button class="paper-btn active" data-paper="A4">A4</button>
                                    <button class="paper-btn" data-paper="A3">A3</button>
                                    <button class="paper-btn" data-paper="A5">A5</button>
                                    <button class="paper-btn" data-paper="B4">B4</button>
                                    <button class="paper-btn" data-paper="B5">B5</button>
                                    <button class="paper-btn" data-paper="Letter">信纸</button>
                                    <button class="paper-btn" data-paper="Legal">法律专用纸</button>
                                    <button class="paper-btn" data-paper="Tabloid">Tabloid</button>
                                    <button class="paper-btn" data-paper="Statement">Statement</button>
                                    <button class="paper-btn" data-paper="Executive">Executive</button>
                                </div>
                            </div>
                            <div class="control-group">
                                <h3>纸张方向</h3>
                                <div class="setting-row">
                                    <div class="setting-item">
                                        <label>纸张方向:</label>
                                        <button class="orientation-btn active" data-orientation="portrait">纵向</button>
                                        <button class="orientation-btn" data-orientation="landscape">横向</button>
                                    </div>
                                </div>
                            </div>

                            <!-- 排版控制区域 -->
                            <div class="control-group">
                                <h3>排版设置</h3>
                                <div class="compact-section-header">
                                    <div class="layout-buttons">
                                        <button class="layout-btn active" data-layout="single">一图一纸</button>
                                        <button class="layout-btn" data-layout="grid">网格布局</button>
                                        <button class="layout-btn" data-layout="vertical">纵向排列</button>
                                        <button class="layout-btn" data-layout="horizontal">横向排列</button>
                                    </div>
                                </div>

                                <!-- 网格布局设置 -->
                                <div class="grid-settings" id="gridSettings" style="display: none;">
                                    <div class="setting-row">
                                        <div class="setting-item">
                                            <label>横向数量:</label>
                                            <input type="number" id="gridCols" min="1" max="8" value="2" style="width: 50px;">
                                        </div>
                                        <div class="setting-item">
                                            <label>纵向数量:</label>
                                            <input type="number" id="gridRows" min="1" max="8" value="2" style="width: 50px;">
                                        </div>
                                    </div>
                                </div>

                                <div class="layout-settings">
                                    <div class="setting-item">
                                        <label>图片间距:</label>
                                        <input type="range" id="spacingSlider" min="0" max="100" value="0">
                                        <span id="spacingValue">0px</span>
                                    </div>
                                    <div class="setting-item">
                                        <label>纸张边距:</label>
                                        <input type="range" id="marginSlider" min="0" max="100" value="0">
                                        <span id="marginValue">0px</span>
                                    </div>
                                    <div class="setting-row">
                                        <div class="setting-item">
                                            <label>水平对齐:</label>
                                            <select id="horizontalAlign">
                                                <option value="center">居中</option>
                                                <option value="top">顶部</option>
                                                <option value="bottom">底部</option>
                                                <option value="left">左边</option>
                                                <option value="right">右边</option>
                                            </select>
                                        </div>
                                        <div class="setting-item">
                                            <label>缩放模式:</label>
                                            <select id="scaleMode">
                                                <option value="contain">等比缩放</option>
                                                <option value="fill">拉伸占满</option>
                                                <option value="scale-down">原始尺寸</option>
                                                <!-- <option value="cover">缩放覆盖</option> -->
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="right-panel">
                        <div class="paper-preview-section">
                            <div class="paper-previews" id="paperPreviewsContainer">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="fixed-btn-group">
            <button id="backToTopBtn" class="floating-btn">↑顶部</button>
            <button id="editStartPrintBtn" class="floating-btn floating-print">打印预览</button>
            <button id="backToEditBtn" class="floating-btn floating-back">← 编辑</button>
            <button id="previewStartPrintBtn" class="floating-btn floating-print">打印</button>
        </div>
        <div id="status" class="status info" style="display: none;"></div>
        

        <!-- 局部放大镜 -->
        <div id="magnifier" class="magnifier">
            <div id="magnifierCoords" class="magnifier-coords"></div>
            <canvas id="magnifierCanvas" class="magnifier-canvas"></canvas>
        </div>
        
        <!-- 控制点悬停效果 -->
        <div id="pointHover" class="point-hover"></div>
        <div class="footer" id="footer">
            Copyright © 2025 fluidcat. Licensed under LGPL v3.
        </div>
    </body>
</html>